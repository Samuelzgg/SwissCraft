<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Swiss Craft – Live</title>
  <style>
    :root{
      --bg:#0b0b10;--card:#12121a;--muted:#a2a6b3;--text:#f3f4f6;--accent:#8b5cf6;--accent-2:#22c55e;--warn:#f59e0b;--danger:#ef4444;
      --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b0b10,#0e0e14);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
    .container{max-width:1200px;margin:40px auto;padding:0 16px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{font-size:clamp(22px,3vw,34px);margin:0}
    .controls{display:flex;gap:10px;flex-wrap:wrap}
    .pill{background:#1a1a25;border:1px solid #24243a;color:var(--text);padding:10px 14px;border-radius:999px}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;font-size:13px;border:1px solid #2a2a40;background:#151522}
    .badge.live{border-color:rgba(139,92,246,.35);background:rgba(139,92,246,.12)}
    .dot{width:8px;height:8px;border-radius:50%}
    .dot.live{background:var(--accent)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;margin-top:18px}
    .card{background:var(--card);border:1px solid #1f2430;border-radius:18px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
    .thumb{position:relative;aspect-ratio:16/9;background:#0f0f15}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .liveTag{position:absolute;top:10px;left:10px;background:var(--danger);color:#fff;font-size:12px;font-weight:700;padding:5px 8px;border-radius:999px}
    .body{padding:14px 14px 16px}
    .rowline{display:flex;align-items:center;gap:10px}
    .avatar{width:28px;height:28px;border-radius:50%;object-fit:cover;border:1px solid #2a2a40}
    .title{font-size:16px;font-weight:700;margin:0 0 6px}
    .meta{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 0}
    .meta .chip{font-size:12px;border:1px solid #2a2a40;background:#161624;padding:4px 8px;border-radius:999px;color:var(--muted)}
    .actions{display:flex;gap:10px;margin-top:12px}
    .btn{appearance:none;border:1px solid #2a2a40;background:#141423;color:var(--text);padding:9px 12px;border-radius:12px;text-decoration:none;font-weight:600;display:inline-flex;align-items:center;gap:8px;cursor:pointer}
    .btn:hover{border-color:#3a3a55;transform:translateY(-1px)}
    .section{margin-top:32px}
    footer{opacity:.65;margin:40px 0 24px;font-size:13px}
    .empty{border:1px dashed #2a2a40;border-radius:14px;padding:24px;color:var(--muted);text-align:center}
    .banner{border:1px solid #3a2a10;background:#211806;color:#f8e6c0;border-radius:12px;padding:12px;display:none;margin:12px 0}
    .banner.error{border-color:#3a1010;background:#210d0d;color:#ffd2d2}
    .divider{height:1px;background:#1f2430;margin:12px 0 0;opacity:.6}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Swiss Craft</h1>
      <div class="controls">
        <span class="badge live"><span class="dot live"></span> Live</span>
        <span class="pill" id="last-updated">Aktualisiert: –</span>
        <button class="btn" id="refresh">Neu laden</button>
      </div>
    </header>

    <div id="banner" class="banner"></div>

    <!-- Live Section -->
    <section class="section" aria-labelledby="live-heading">
      <h2 id="live-heading">Gerade live</h2>
      <div id="live-grid" class="grid"></div>
      <div id="live-empty" class="empty" style="display:none">Derzeit ist niemand live.</div>
    </section>

    <!-- Twitch roster stacked -->
    <section class="section" aria-labelledby="roster-twitch-heading">
      <h2 id="roster-twitch-heading">Teilnehmer – Twitch</h2>
      <div class="divider"></div>
      <div id="roster-twitch" class="grid"></div>
    </section>

    <!-- Other platforms roster stacked -->
    <section class="section" aria-labelledby="roster-other-heading">
      <h2 id="roster-other-heading">Teilnehmer – Andere Plattformen</h2>
      <div class="divider"></div>
      <div id="roster-other" class="grid"></div>
    </section>

    <footer>
      <div>Automatische Aktualisierung alle 60 Sekunden. Datenquelle: Twitch Helix API.</div>
    </footer>
  </div>

  <script>
    const CLIENT_ID = "zxg5h7z2fm3cli0ywa7j84gk1xang7";
    const ACCESS_TOKEN = "kbttz8dmt97re9w6urwedgkyofwm5a";

    const TWITCH_CHANNELS = [
      { name: 'MaeloRomani', login: 'maeloromani' },
      { name: 'Elijah Tetilla', login: 'elijahtetillaa' },
      { name: 'laisalicious', login: 'laisalicious' },
      { name: 'Naxlani', login: 'naxlani' },
      { name: 'SandroSchmitter', login: 'sandroschmitter' },
      { name: 'JenniferJordii', login: 'jenniferjordii' },
      { name: 'SamuSari', login: 'samusari' },
      { name: 'Strike', login: 'strike' },
      { name: 'prinznorin', login: 'prinznorin' },
      { name: 'Samuel.zgg', login: 'samuel_zgg' },
      { name: 'Nimmbaa', login: 'nimmbaa' },
      { name: 'Sändu2k', login: 'saendu2k' },
      { name: 'Monkeey99', login: 'monkeey99' },
      { name: 'DreamyRere', login: 'dreamyrere' },
      { name: 'Sir_Cooli', login: 'sir_cooli' },
      { name: 'gery_live', login: 'gery_live' },
      { name: 'Jakofski37', login: 'jakofski37' },
      { name: 'KxEx', login: 'iamkxex' },
      { name: 'onklskoko', login: 'onklskoko' },
      { name: 'its_Mauz1', login: 'its_mauz1' },
      { name: 'Helagon', login: 'helagon_' },
      { name: 'Serox', login: 'itzseroxlive' },
      { name: 'TechnobirdxD', login: 'technobirdxd' }
    ];

    const OTHER_LINKS = [
      { name: 'ML Gamer', url: 'https://www.tiktok.com/@ml_gameryt', platform: 'TikTok' },
      { name: 'ddy.davee', url: 'https://www.tiktok.com/@ddy.davee', platform: 'TikTok' },
      { name: 'Logik66', url: 'https://www.tiktok.com/@logiksixtysix', platform: 'TikTok' }
    ];

    const liveGrid=document.getElementById('live-grid');
    const liveEmpty=document.getElementById('live-empty');
    const rosterTwitch=document.getElementById('roster-twitch');
    const rosterOther=document.getElementById('roster-other');
    const lastUpdated=document.getElementById('last-updated');
    const banner=document.getElementById('banner');

    const showBanner=(m,t='warn')=>{banner.textContent=m;banner.className='banner '+(t==='error'?'error':'');banner.style.display='block';};
    const hideBanner=()=>{banner.style.display='none';};
    const fmtTime=(d)=>new Intl.DateTimeFormat(undefined,{dateStyle:'short',timeStyle:'short'}).format(d);
    const sinceText=(iso)=>{const s=new Date(iso);const m=Math.max(0,Math.round((Date.now()-s.getTime())/60000));if(m<1)return'gerade eben';if(m<60)return`seit ${m} Min`;const h=Math.floor(m/60),r=m%60;return`seit ${h} Std ${r} Min`;};

    function channelCard(item,isLive){
      const url=`https://twitch.tv/${item.login}`;
      const title=isLive?(item.title||item.display_name||item.login):(item.display_name||item.login);
      const game=isLive?(item.game_name||''):'';
      const viewers=isLive?(item.viewer_count??null):null;
      const started=isLive?(item.started_at?sinceText(item.started_at):''):'';
      const thumb=isLive&&item.thumbnail_url?item.thumbnail_url.replace('{width}','640').replace('{height}','360'):null;

      const card=document.createElement('article');card.className='card';
      const thumbDiv=document.createElement('div');thumbDiv.className='thumb';
      if(thumb){const img=document.createElement('img');img.loading='lazy';img.src=thumb+`?t=${Date.now()}`;thumbDiv.appendChild(img);const tag=document.createElement('div');tag.className='liveTag';tag.textContent='LIVE';thumbDiv.appendChild(tag);}
      card.appendChild(thumbDiv);

      const body=document.createElement('div');body.className='body';
      const row=document.createElement('div');row.className='rowline';
      if(item.profile_image_url){const av=document.createElement('img');av.className='avatar';av.src=item.profile_image_url;row.appendChild(av);}
      const h3=document.createElement('h3');h3.className='title';h3.textContent=title;row.appendChild(h3);body.appendChild(row);

      const actions=document.createElement('div');actions.className='actions';
      const a=document.createElement('a');a.className='btn';a.href=url;a.target='_blank';a.rel='noopener';a.textContent='Zum Stream';actions.appendChild(a);body.appendChild(actions);

      const meta=document.createElement('div');meta.className='meta';
      if(isLive&&game){const chip=document.createElement('span');chip.className='chip';chip.textContent=`Spiel: ${game}`;meta.appendChild(chip);}
      if(isLive&&viewers!=null){const chip=document.createElement('span');chip.className='chip';chip.textContent=`${viewers} Zuschauer`;meta.appendChild(chip);}
      if(isLive&&started){const chip=document.createElement('span');chip.className='chip';chip.textContent=started;meta.appendChild(chip);}
      body.appendChild(meta);

      card.appendChild(body);return card;
    }

    async function fetchStreams(logins){
      const p=new URLSearchParams();logins.forEach(l=>p.append('user_login',l));
      const res=await fetch('https://api.twitch.tv/helix/streams?'+p,{headers:{'Client-ID':CLIENT_ID,'Authorization':'Bearer '+ACCESS_TOKEN}});
      if(!res.ok)throw new Error('Streams Fehler: '+res.status);return(await res.json()).data||[];
    }

    async function fetchUsers(logins){
      const p=new URLSearchParams();logins.forEach(l=>p.append('login',l));
      const res=await fetch('https://api.twitch.tv/helix/users?'+p,{headers:{'Client-ID':CLIENT_ID,'Authorization':'Bearer '+ACCESS_TOKEN}});
      if(!res.ok)throw new Error('Users Fehler: '+res.status);return(await res.json()).data||[];
    }

    async function render(){
      const all=TWITCH_CHANNELS.map(c=>c.login.toLowerCase());
      try{
        const [streams,users]=await Promise.all([fetchStreams(all),fetchUsers(all)]);
        const liveMap=new Map(streams.map(s=>[(s.user_login||s.user_name).toLowerCase(),s]));
        const userMap=new Map(users.map(u=>[u.login.toLowerCase(),u]));

        liveGrid.innerHTML='';
        rosterTwitch.innerHTML='';

        // Live
        const live=[];
        for(const c of TWITCH_CHANNELS){
          const s=liveMap.get(c.login.toLowerCase());
          if(s){s.display_name=userMap.get(c.login.toLowerCase())?.display_name||c.name;s.profile_image_url=userMap.get(c.login.toLowerCase())?.profile_image_url;live.push(s);}
        }
        if(live.length===0){liveEmpty.style.display='block';}
        else{liveEmpty.style.display='none';live.forEach(s=>liveGrid.appendChild(channelCard(s,true)));}

        // Teilnehmer Twitch
        for(const c of TWITCH_CHANNELS){
          const u=userMap.get(c.login.toLowerCase())||{login:c.login,display_name:c.name,profile_image_url:null};
          const card=document.createElement('article');card.className='card';
          const body=document.createElement('div');body.className='body';
          const row=document.createElement('div');row.className='rowline';
          if(u.profile_image_url){const av=document.createElement('img');av.className='avatar';av.src=u.profile_image_url;row.appendChild(av);}
          const h=document.createElement('h3');h.className='title';h.textContent=u.display_name;row.appendChild(h);body.appendChild(row);
          const actions=document.createElement('div');actions.className='actions';
          const a=document.createElement('a');a.className='btn';a.href=`https://twitch.tv/${u.login}`;a.target='_blank';a.textContent='Profil öffnen';actions.appendChild(a);body.appendChild(actions);
          card.appendChild(body);rosterTwitch.appendChild(card);
        }

        // Teilnehmer Andere
        rosterOther.innerHTML='';
        OTHER_LINKS.forEach(it=>{
          const card=document.createElement('article');card.className='card';
          const body=document.createElement('div');body.className='body';
          const h=document.createElement('h3');h.className='title';h.textContent=it.name;body.appendChild(h);
          const actions=document.createElement('div');actions.className='actions';
          const a=document.createElement('a');a.className='btn';a.href=it.url;a.target='_blank';a.textContent='Profil öffnen';actions.appendChild(a);body.appendChild(actions);
          card.appendChild(body);rosterOther.appendChild(card);
        });

        lastUpdated.textContent='Aktualisiert: '+fmtTime(new Date());
        hideBanner();
      }catch(e){
        console.error(e);showBanner('Fehler beim Laden: '+e.message,'error');
      }
    }

    document.getElementById('refresh').addEventListener('click',render);
    setInterval(render,60000);
    render();
  </script>
</body>
</html>

